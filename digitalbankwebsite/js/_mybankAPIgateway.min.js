var _mybankAPIgateway=angular.module("_mybankAPIgateway",[]);_mybankAPIgateway.controller("_mybankAPIgatewayController",["$scope","$http",function(e,a){e.customer={},e.account={},e.transactions={},e.reset={},e.data={query:"SELECT CONCAT('[', GROUP_CONCAT(JSON_OBJECT(%fields%)), ']') as jsonresult from %TABLE_NAME%;",queryresponse:"",eventquery:"SELECT CONCAT('[', GROUP_CONCAT(JSON_OBJECT('eventsource',eventsource,'eventdestination',eventdestination,'eventstatus',eventstatus,'eventdirection',eventdirection,'eventdata',eventdata,'createdate',createdate) order by createdate desc), ']') as jsonresult from tEvents;"},e.data.querytemplate={create:"INSERT INTO %TABLE_NAME% (%fields%) VALUES (%values%);",delete:"DELETE FROM %TABLE_NAME% WHERE _id in (%ID_LIST%);",update:"UPDATE %TABLE_NAME% SET %fields% WHERE _id = %_ID%;",read:"SELECT CONCAT('[', GROUP_CONCAT(JSON_OBJECT(%fields%)), ']') as jsonresult from %TABLE_NAME%;"},e.data.customer={tablename:"tcustomer",insertfields:"customername,customeraddress,customerphone",selectfields:"'_id',_id,'customername',customername,'customeraddress',customeraddress,'customerphone',customerphone",eventsource:"customer"},e.data.account={tablename:"taccount",insertfields:"accountname,accountbalance",selectfields:"'_id',_id,'accountname',accountname,'accountbalance',accountbalance",eventsource:"account"},e.data.transactions={tablename:"ttransactions",insertfields:"idsender,idreceiver,transferamount",selectfields:"'_id',_id,'createdate',createdate,'idsender',idsender,'idreceiver',idreceiver,'transferamount',transferamount",eventsource:"transactions"},e.customer.executequery=function(){a({method:"POST",url:"http://localhost:8081/mybank/customer/executequery/",dataType:"json",data:{query:e.data.query,source:e.data.customer.eventsource},headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(a){e.msg="Customer POST data submitted successfully!",e.data.queryresponse=a.data},function(a){e.msg="Service does not exist (Customer) "+a.data,e.statusval=a.status,e.statustext=a.statusText,e.headers=a.headers()})},e.account.executequery=function(){a({method:"POST",url:"http://localhost:8082/mybank/account/executequery/",dataType:"json",data:{query:e.data.query,source:e.data.account.eventsource},headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(a){e.msg="Accounts POST data submitted successfully!",e.data.queryresponse=a.data},function(a){e.msg="Service does not exist (Accounts) "+a.data,e.statusval=a.status,e.statustext=a.statusText,e.headers=a.headers()})},e.transactions.executequery=function(){a({method:"POST",url:"http://localhost:8083/mybank/transactions/executequery/",dataType:"json",data:{query:e.data.query,source:e.data.transactions.eventsource},headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(a){e.msg="Transactions POST data submitted successfully!",e.data.queryresponse=a.data},function(a){e.msg="Service does not exist (Transactions) "+a.data,e.statusval=a.status,e.statustext=a.statusText,e.headers=a.headers()})},e.data.customer.selectquery=function(){e.data.query=e.data.querytemplate.read,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.customer.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.customer.selectfields),e.customer.executequery(),e.showcustomertable=1},e.data.customer.insertquery=function(){var a="";e.data.query=e.data.querytemplate.create,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.customer.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.customer.insertfields),a="'"+e.form.customer.name+"','"+e.form.customer.address+"','"+e.form.customer.phone+"'",e.data.query=e.data.query.replace(/%values%/,a),e.customer.executequery(),e.form.customer=angular.copy(e.reset)},e.data.customer.deletequery=function(){e.data.query=e.data.querytemplate.delete,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.customer.tablename),e.data.query=e.data.query.replace(/%ID_LIST%/,e.form.customer._id),e.customer.executequery(),e.form.customer=angular.copy(e.reset)},e.data.customer.updatequery=function(){e.data.query=e.data.querytemplate.update,e.data.customer.updatefields="customername='"+e.form.customer.name+"',customeraddress='"+e.form.customer.address+"',customerphone='"+e.form.customer.phone+"'",e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.customer.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.customer.updatefields),e.data.query=e.data.query.replace(/%_ID%/,e.form.customer._id),e.customer.executequery(),e.form.customer=angular.copy(e.reset)},e.data.account.selectquery=function(){e.data.query=e.data.querytemplate.read,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.account.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.account.selectfields),e.account.executequery()},e.data.account.insertquery=function(){var a="";e.data.query=e.data.querytemplate.create,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.account.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.account.insertfields),a="'"+e.form.account.name+"','"+e.form.account.balance+"'",e.data.query=e.data.query.replace(/%values%/,a),e.account.executequery(),e.form.account=angular.copy(e.reset)},e.data.account.deletequery=function(){e.data.query=e.data.querytemplate.delete,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.account.tablename),e.data.query=e.data.query.replace(/%ID_LIST%/,e.form.account._id),e.account.executequery(),e.form.account=angular.copy(e.reset)},e.data.account.updatequery=function(){e.data.query=e.data.querytemplate.update,e.data.account.updatefields="accountname='"+e.form.account.name+"',accountbalance='"+e.form.account.balance+"'",e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.account.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.account.updatefields),e.data.query=e.data.query.replace(/%_ID%/,e.form.account._id),e.account.executequery(),e.form.account=angular.copy(e.reset)},e.data.transactions.selectquery=function(){e.data.query=e.data.querytemplate.read,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.transactions.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.transactions.selectfields),e.transactions.executequery()},e.data.transactions.insertquery=function(){var a="";e.data.query=e.data.querytemplate.create,e.data.query=e.data.query.replace(/%TABLE_NAME%/,e.data.transactions.tablename),e.data.query=e.data.query.replace(/%fields%/,e.data.transactions.insertfields),a="'"+e.form.transactions.idsender+"','"+e.form.transactions.idreceiver+"','"+e.form.transactions.transferamount+"'",e.data.query=e.data.query.replace(/%values%/,a),e.transactions.executequery(),e.form.transactions=angular.copy(e.reset)},e.data.account.vieweventlog=function(){a({method:"POST",url:"http://localhost:8082/mybank/account/executequery/",dataType:"json",data:{query:e.data.eventquery},headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(a){e.msg="EventLog POST data submitted successfully!",e.account.eventlog=a.data},function(a){e.msg="Service does not exist (EventLog) "+a.data,e.statusval=a.status,e.statustext=a.statusText,e.headers=a.headers()})}}]);